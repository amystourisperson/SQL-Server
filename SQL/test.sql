CREATE DATABASE QUANLYBANHANG

GO

DROP TABLE IF EXISTS HANGSX;
DROP TABLE IF EXISTS SANPHAM;
DROP TABLE IF EXISTS NHANVIEN;
DROP TABLE IF EXISTS PNHAP;
DROP TABLE IF EXISTS NHAP;
GO

USE QUANLYBANHANG

GO

CREATE TABLE HANGSX
(
	MaHangSX NCHAR(10) PRIMARY KEY NOT NULL,
	TenHang NVARCHAR(20) NOT NULL,
	DiaChi NVARCHAR(30) NOT NULL,
	SoDT NVARCHAR(20) NOT NULL,
	Email NVARCHAR(30) NOT NULL
)

CREATE TABLE SANPHAM
(
	MaSP NCHAR(10) PRIMARY KEY NOT NULL,
	MaHangSX NCHAR(10) NOT NULL,
	CONSTRAINT FK_MaHangSX FOREIGN KEY(MaHangSX)
		REFERENCES HANGSX(MaHangSX),
	TenSP NVARCHAR(20) NOT NULL,
	SoLuong INT,
	MauSac NVARCHAR(20) NOT NULL,
	GiaBan MONEY,
	DonViTinh NCHAR(10) NOT NULL,
	MoTa NVARCHAR(MAX)
)

CREATE TABLE NHANVIEN
(
	MaNV NCHAR(10) PRIMARY KEY NOT NULL,
	TenNV NVARCHAR(20) NOT NULL,
	GioiTinh NCHAR(10) NOT NULL,
	DiaChi NVARCHAR(30) NOT NULL,
	SoDT NVARCHAR(20) NOT NULL,
	Email NVARCHAR(30) NOT NULL,
	TenPhong NVARCHAR(30),
)

CREATE TABLE PNHAP
(
	SoHDN NCHAR(10) PRIMARY KEY NOT NULL,
	NgayNhap DATE NOT NULL,
	MaNV NCHAR(10) NOT NULL,
	CONSTRAINT FK_MaNV FOREIGN KEY(MaNV)
		REFERENCES NHANVIEN(MaNV),
)

CREATE TABLE NHAP
(
	SoHDN NCHAR(10) NOT NULL,
	MaSP NCHAR(10) NOT NULL,
	CONSTRAINT PK_NHAP PRIMARY KEY(SoHDN, MaSP),
	CONSTRAINT FK_NHAP_PNHAP FOREIGN KEY(SoHDN)
		REFERENCES PNHAP(SoHDN),
	CONSTRAINT FK_NHAP_SANPHAM FOREIGN KEY(MaSP)
		REFERENCES SANPHAM(MaSP),
	SoLuongN INT,
	DonGiaN MONEY,
)


CREATE TABLE PXUAT
(
	SoHDX NCHAR(10) PRIMARY KEY NOT NULL,
	NgayXuat DATE NOT NULL,
	MaNV NCHAR(10) NOT NULL,
	CONSTRAINT FK_MaNV_xuat FOREIGN KEY(MaNV)
		REFERENCES NHANVIEN(MaNV),
)

CREATE TABLE XUAT
(
	SoHDX NCHAR(10) NOT NULL,
	MaSP NCHAR(10) NOT NULL,
	CONSTRAINT PK_XUAT PRIMARY KEY(SoHDX, MaSP),
	CONSTRAINT FK_XUAT_PXUAT FOREIGN KEY(SoHDX)
		REFERENCES PXUAT(SoHDX),
	CONSTRAINT FK_XUAT_SANPHAM FOREIGN KEY(MaSP)
		REFERENCES SANPHAM(MaSP),
	SoLuongX INT,

)

--Them du lieu vao bang
DELETE FROM HANGSX;

INSERT INTO HANGSX([MaHangSX],[TenHang],[DiaChi],[SoDT],[Email]) VALUES
	('H01', 'Samsung', 'Korea', '011-08271717', 'ss@gmail.com.kr'),
	('H02', 'OPPO', 'China', '021-08626262', 'oppo@gmail.com.cn'),
	('H03', 'Vinafone', N'Việt Nam', '081-08279717', 'vf@gmail.com.vn')

DELETE FROM NHANVIEN;

INSERT INTO NHANVIEN([MaNV],[TenNV],[GioiTinh],[DiaChi],[SoDT],[Email],[TenPhong]) VALUES
	('NV01', N'Nguyễn Thị Thu', N'Nữ', N'Hà nội', '0982626521', 'thu@gmail.com', N'Kế toán'),
	('NV02', N'Lê Văn Nam', N'Nam', N'Bắc Ninh', '0972525252', 'nam@gmail.com', N'Vật tư'),
	('NV03', N'Trần Hòa Bình', N'Nữ', N'Hà nội', '0328388388', 'hb@gmail.com', N'Kế toán')

INSERT INTO SANPHAM([MaSP],[MaHangSX],[TenSP],[SoLuong],[MauSac],[GiaBan],[DonViTinh],[MoTa]) VALUES
	('SP01', 'H02','F1 Plus', 100, N'Xám', 700000, N'Chiêc', N'Hàng cận cao cấp'),
	('SP02', 'H01','Glaxy Note11', 50, N'Đỏ', 19000000, N'Chiêc', N'Hàng cao cấp'),
	('SP03', 'H02','F3 Lite', 200, N'Nâu', 300000, N'Chiêc', N'Hàng phổ thông'),
	('SP04', 'H03','Vjoy3', 200, N'Xám', 1500000, N'Chiêc', N'Hàng phổ thông'),
	('SP05', 'H01','Glaxy V21', 500, N'Nâu', 800000, N'Chiêc', N'Hàng cận cao cấp')

INSERT INTO PNHAP(SoHDN, NgayNhap, MaNV) VALUES
('N01', '2019-05-02', 'NV01'),
('N02', '2020-07-04', 'NV02'),
('N03', '2020-05-17', 'NV02'),
('N04', '2020-03-22', 'NV03'),
('N05', '2020-07-07', 'NV01');

DELETE FROM NHAP;

INSERT INTO NHAP(SoHDN, MaSP, SoLuongN, DonGiaN) VALUES
('N01', 'SP02', 10, 17000000),
('N02', 'SP01', 30, 6000000),
('N03', 'SP04', 20, 12000000),
('N04', 'SP01', 10, 6200000),
('N05', 'SP05', 20, 7000000);


INSERT INTO PXUAT (SoHDX, NgayXuat, MaNV) VALUES
('X01', '2020-06-14', 'NV02'),
('X02', '2019-05-03', 'NV03'),
('X03', '2020-12-12', 'NV01'),
('X04', '2020-06-02', 'NV02'),
('X05', '2020-05-18', 'NV01');


INSERT INTO XUAT (SoHDX, MaSP, SoLuongX) VALUES
('X01', 'SP03', 5),
('X02', 'SP01', 3),
('X03', 'SP02', 1),
('X04', 'SP03', 2),
('X05', 'SP05', 1);

SELECT * from HANGSX
SELECT * from NHANVIEN
SELECT * from SANPHAM
SELECT * from PNHAP
SELECT * FROM NHAP
SELECT * from PXUAT
SELECT * FROM XUAT

